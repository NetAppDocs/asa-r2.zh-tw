---
sidebar: sidebar 
permalink: manage-data/provision-san-storage.html 
keywords: provision storage,san, create storage units, luns, namespaces, nvme, add host, add host initiators, map host, host mapping, create, ontap 
summary: 在 ASA R2 上佈建 ONTAP 儲存設備、讓 SAN （ SCSI 和 NVMe ）主機能夠讀寫資料至指定的儲存單元（ LUN 和 NVMe 命名空間）。 
searchtitle: 使用 ONTAP System Manager | ASA R2 來配置 SAN 儲存設備 
---
= 在 ASA R2 系統上配置 ONTAP SAN 儲存設備
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
在配置儲存設備時、您可以讓 SAN 主機從 ASA R2 儲存系統讀取資料並將資料寫入其中。若要配置儲存設備、您可以使用 ONTAP 系統管理員來建立儲存單元、新增主機啟動器、以及將主機對應至儲存單元。您也需要在主機上執行步驟、以啟用讀取 / 寫入作業。



== 建立儲存單元

在 ASA R2 系統上、儲存單元可為 SAN 主機提供儲存空間、以供資料作業使用。儲存單元是指 SCSI 主機的 LUN 或 NVMe 主機的 NVMe 命名空間。如果您的叢集設定為支援 SCSI 主機、系統會提示您建立 LUN 。如果您的叢集設定為支援 NVMe 主機、系統會提示您建立 NVMe 命名空間。ASA R2 儲存單元的最大容量為 128TB 。

如link:https://hwu.netapp.com/["NetApp Hardware Universe"^]需 ASA R2 系統的最新儲存限制、請參閱。

主機啟動器會在儲存單元建立程序中新增並對應至儲存單元。您也可以link:provision-san-storage.html#add-host-initiators["新增主機啟動器"] link:provision-san-storage.html#map-the-storage-unit-to-a-host["地圖"]在建立儲存單元之後、將其儲存至儲存單元。

.步驟
. 在 System Manager 中，選擇 *Storage* ；然後選擇image:icon_add_blue_bg.png["藍色背景的矩形圖示、文字會以白色字母為中心"]。
. 輸入新儲存單元的名稱。
. 輸入您要建立的單位數量。
+
如果您建立一個以上的儲存單元、則會以相同的容量、主機作業系統和主機對應來建立每個單元。

. 輸入儲存單元容量、然後選取主機作業系統。
. 接受自動選取的 * 主機對應 * 、或選取要對應儲存單元的不同主機群組。
+
* 主機對應 * 是指將新儲存單元對應至的主機群組。如果您為新儲存單元選取的主機類型有預先存在的主機群組、則會自動為主機對應選取預先存在的主機群組。您可以接受自動為主機對應選取的主機群組、也可以選取不同的主機群組。

+
如果在您指定的作業系統上執行的主機沒有預先存在的主機群組、則 ONTAP 會自動建立新的主機群組。

. 如果您想執行下列任何一項、請選取 * 更多選項 * 、然後完成所需步驟。
+
[cols="2, 4a"]
|===
| 選項 | 步驟 


 a| 
變更預設的服務品質（ QoS ）原則

如果先前未在要建立儲存單元的儲存虛擬機器（ VM ）上設定預設 QoS 原則、則無法使用此選項。
 a| 
.. 在 * 儲存與最佳化 * 下、在 * 服務品質（ QoS ） * 旁image:icon_dropdown_arrow.gif["指向下方向的藍色箭頭圖示"]、選擇。
.. 選取現有的 QoS 原則。




 a| 
建立新的 QoS 原則
 a| 
.. 在 * 儲存與最佳化 * 下、在 * 服務品質（ QoS ） * 旁image:icon_dropdown_arrow.gif["指向下方向的藍色箭頭圖示"]、選擇。
.. 選取 * 定義新原則 * 。
.. 輸入新 QoS 原則的名稱。
.. 設定 QoS 限制、 QoS 保證或兩者。
+
... 或者、在 * 限制 * 下、輸入最大處理量限制、最大 IOPS 限制或兩者。
+
設定儲存單元的最大處理量和 IOPS 會限制其對系統資源的影響、使其不會降低關鍵工作負載的效能。

... 您也可以在 * 保證 * 下輸入最小處理量、最小 IOPS 或兩者。
+
設定儲存單元的最低處理量和 IOPS 、可確保它符合最低效能目標、無論競爭工作負載的需求為何。



.. 選取*「Add*」。




 a| 
新增 SCSI 主機
 a| 
.. 在 * 主機資訊 * 下、選取 * SCSI * 作為連線傳輸協定。
.. 選取主機作業系統。
.. 在 * 主機對應 * 下、選取 * 新主機 * 。
.. 選取 * FC* 或 * iSCSI * 。
.. 選取現有的主機啟動器、或選取 * 新增啟動器 * 以新增主機啟動器。
+
有效的 FC WWPN 範例為「 01:02:03:04:0A:0b:0c:0d 」。有效的 iSCSI 啟動器名稱範例為「 iqn.1995-08.com.example:string" 」和「 EUI.0123456789abcdef 」。





 a| 
建立新的 SCSI 主機群組
 a| 
.. 在 * 主機資訊 * 下、選取 * SCSI * 作為連線傳輸協定。
.. 選取主機作業系統。
.. 在 * 主機對應 * 下、選取 * 新主機群組 * 。
.. 輸入主機群組的名稱、然後選取要新增至群組的主機。




 a| 
新增 NVMe 子系統
 a| 
.. 在 * 主機資訊 * 下、選取 * NVMe * 作為連線傳輸協定。
.. 選取主機作業系統。
.. 在 * 主機對應 * 下、選取 * 新的 NVMe 子系統 * 。
.. 輸入子系統的名稱或接受預設名稱。
.. 輸入啟動器的名稱。
.. 如果您想要啟用頻內驗證或傳輸層安全性（ TLS ）、請選取image:icon_dropdown_arrow.gif["指向下方向的藍色箭頭圖示"]；然後選取您的選項。
+
頻內驗證可在 NVMe 主機和 ASA R2 系統之間進行安全的雙向單向驗證。

+
TLS 會加密透過網路在您的 NVMe / TCP 主機和 ASA R2 系統之間傳送的所有資料。

.. 選取 * 新增啟動器 * 以新增更多啟動器。
+
主機 NQN 應格式化為 <nqn.yyyy-mm> 、後面接著完整網域名稱。年應等於或晚於 1970 年。總長度應為 223 。有效的 NVMe 啟動器範例是 nqn.2014-08.com.example:string



|===
. 選取*「Add*」。


.接下來呢？
系統會建立儲存單元、並將其對應至主機。您現在可以link:../data-protection/create-snapshots.html["建立快照"]保護 ASA R2 系統上的資料。

.以取得更多資訊
深入瞭解 link:../administer/manage-client-vm-access.html["ASA R2 系統如何使用儲存虛擬機器"]。



== 新增主機啟動器

您可以隨時將新的主機啟動器新增至 ASA R2 系統。啟動器可讓主機存取儲存單元並執行資料作業。

.開始之前
如果您想在新增主機啟動器的過程中、將主機組態複寫到目的地叢集、則叢集必須處於複寫關係中。您也可以選擇link:../data-protection/snapshot-replication.html#step-3-create-a-replication-relationship["建立複寫關係"]在新增主機之後進行。

新增 SCSI 或 NVMe 主機的主機啟動器。

[role="tabbed-block"]
====
.SCSI主機
--
.步驟
. 選取 * 主機 * 。
. 選擇 *SCSI* ，然後選擇image:icon_add_blue_bg.png["藍色矩形的圖示、包含加號、接著加上白色字母的新增字詞"]。
. 輸入主機名稱、選取主機作業系統、然後輸入主機說明。
. 如果要將主機組態複寫到目的地叢集、請選取 * 複寫主機組態 * 、然後選取目的地叢集。
+
您的叢集必須處於複寫關係中、才能複寫主機組態。

. 新增或現有主機。
+
[cols="2"]
|===
| 新增主機 | 新增現有主機 


 a| 
.. 選取 * 新主機 * 。
.. 選取 * FC* 或 * iSCSI * ；然後選取主機啟動器。
.. （可選）選擇 * 配置主機鄰近 * 。
+
設定主機鄰近度可讓 ONTAP 識別最靠近主機的控制器、以進行資料路徑最佳化和縮短延遲。這僅適用於將資料複寫到遠端位置的情況。如果您尚未設定快照複寫、則不需要選取此選項。

.. 如果您需要新增啟動器、請選取 * 新增啟動器 * 。

 a| 
.. 選擇 * 現有主機 * 。
.. 選取您要新增的主機。
.. 選取*「Add*」。


|===
. 選取*「Add*」。


.接下來呢？
您的 SCSI 主機會新增至 ASA R2 系統、並準備好將主機對應至儲存單元。

--
.NVMe 主機
--
.步驟
. 選取 * 主機 * 。
. 選擇 * NVMe * 、然後選擇image:icon_add_blue_bg.png["藍色背景的矩形圖示、文字會以白色字母為中心"]。
. 輸入 NVMe 子系統的名稱、選取主機作業系統並輸入說明。
. 選取 * 新增啟動器 * 。


.接下來呢？
您的 NVMe 主機已新增至 ASA R2 系統、您可以將主機對應至儲存單元。

--
====


== 建立主機群組

在 ASA R2 系統上、 _ 主機群組 _ 是用於讓主機存取儲存單元的機制。主機群組是指 SCSI 主機的 igroup 、或 NVMe 主機的 NVMe 子系統。主機只能看到對應至其所屬主機群組的儲存單元。當主機群組對應至儲存單元時、屬於群組成員的主機便能掛載（在上建立目錄和檔案結構）儲存單元。

當您建立儲存單元時、會自動或手動建立主機群組。您可以選擇在建立儲存單元之前或之後、使用下列步驟來建立主機群組。

.步驟
. 從 System Manager 中選取 * 主機 * 。
. 選取要新增至主機群組的主機。
+
選取第一個主機之後、要新增至主機群組的選項會出現在主機清單上方。

. 選取 * 新增至主機群組 * 。
. 搜尋並選取您要新增主機的主機群組。


.接下來呢？
您已建立主機群組、現在可以將其對應至儲存單元。



== 將儲存單元對應至主機

建立 ASA R2 儲存單元並新增主機啟動器之後、您必須將主機對應至儲存單元、才能開始提供資料服務。儲存單元會在儲存單元建立程序中對應至主機。您也可以隨時將現有的儲存單元對應至新的或現有的主機。

.步驟
. 選擇 * 儲存 * 。
. 將游標移至您要對應的儲存單元名稱上方。
. 選取image:icon_kabob.gif["三個垂直藍點"]；然後選取 * 對應至主機 * 。
. 選取您要對應至儲存單元的主機、然後選取 * 地圖 * 。


.接下來呢？
您的儲存單元已對應至主機、您已準備好完成主機上的資源配置程序。



== 完整的主機端資源配置

建立儲存單元、新增主機啟動器並對應儲存單元之後、您必須先在主機上執行一些步驟、才能在 ASA R2 系統上讀寫資料。

.步驟
. 對於 FC 和 FC/NVMe 、請依照 WWPN 將 FC 交換器分區。
+
每個啟動器使用一個區域、並在每個區域中包含所有目標連接埠。

. 探索新的儲存單元。
. 初始化儲存單元和建立檔案系統。
. 確認主機可以在儲存單元上讀取和寫入資料。


.接下來呢？
您已完成資源配置程序、準備好開始提供資料。您現在可以link:../data-protection/create-snapshots.html["建立快照"]保護 ASA R2 系統上的資料。

.以取得更多資訊
如需主機端組態的詳細資訊、請參閱link:https://docs.netapp.com/us-en/ontap-sanhost/["ONTAP SAN 主機文件"^]適用於您特定主機的。
